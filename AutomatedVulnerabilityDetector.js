const ethers = require('ethers');

async function scanContract(address, abi) {
    console.log(`Starting security scan for: ${address}`);
    const provider = new ethers.providers.JsonRpcProvider(process.env.RPC_URL);
    const contract = new ethers.Contract(address, abi, provider);

    const bytecode = await provider.getCode(address);
    
    // Check for selfdestruct
    if (bytecode.includes('ff')) {
        console.warn("CRITICAL: SELFDESTRUCT opcode detected!");
    }

    // Check for delegatecall
    if (bytecode.includes('f4')) {
        console.warn("WARNING: DELEGATECALL detected. Check for proxy vulnerabilities.");
    }

    console.log("Scan complete. Review logs for manual analysis.");
}
